{
  "Nova Página": {
    "prefix": "ai-nova-pagina",
    "body": [
      "<%@ codepage=65001 language=\"VBScript\" %>",
      "<!--#include virtual=\"/ai/verificar_origem.asp\"-->",
      "<!--#include virtual=\"/ai/verificar_autorizado.asp\"-->",
      "<!--#include virtual=\"/ai/verificar_modulo.asp\"-->",
      "<!--#include virtual=\"/ai/asp/funcoes.asp\"-->",
      "<!--#include virtual=\"/ai/asp/config.asp\"-->",
      "<!--#include virtual=\"/ai/asp/JSON_2.0.4.asp\"-->",
      "<!--#include virtual=\"/ai/asp/SQLDados.asp\"-->",
      "<!--#include virtual=\"/ai/asp/ListarDados.asp\"-->",
      "<%",
      "  app = \"${1:$TM_FILENAME_BASE}\"",
      "  pagina_atual = \"${RELATIVE_FILEPATH/([^\\\\]+)|(\\\\)/${1}${2:+/}/g}\"",
      "  div_listagem = app & \"_div_listagem\"",
      "  div_acoes = app & \"_div_acoes\"",
      "  seletor_listar = \"listar\"",
      "  seletor_paginas = \"p\"",
      "  p = request.form(seletor_paginas)",
      "  id_tabela = \"${2:id_tabela}\"",
      "  nome_tabela = \"${3:nome_tabela}\"",
      "  id = request.form(id_tabela)",
      "  select case p",
      "    case \"adicionar\", \"editar\", \"visualizar\"",
      "      set ligacao = server.createObject(\"adodb.connection\")",
      "      ligacao.open ${4|conexao,conexaoconsultas,conexaocaaf,conexaointranet,conexaocdm,conexaofeac,conexaologs,conexaoestatisticas,conexaorelogiodeponto,conexaocompamid,conexaocrp,conexaodev,conexaoidq,conexaosgc,conexaosiads,conexaoemrrci,conexaoplataforma,conexaosapa|}",
      "      if err.number <> 0 then",
      "        logerros(err.description)",
      "        err.clear",
      "      end if",
      "      if p = \"editar\" or p = \"visualizar\" then",
      "        operacao = \"\"",
      "        if p = \"editar\" then operacao = \"atualizar\"",
      "        sql_listar = \"SELECT /* Campos A Selecionar */ utilizador_registo, FORMAT(data_registo, 'dd/MM/yyyy HH:mm:ss') AS data_registo_formatada, utilizador_alteracao, FORMAT(data_alteracao, 'dd/MM/yyyy HH:mm:ss') AS data_alteracao_formatada FROM \" & nome_tabela & \" WHERE \" & id_tabela & \" = ?\"",
      "        set comando_sql = server.createobject(\"adodb.command\")",
      "        with comando_sql",
      "          .activeconnection = ligacao",
      "          .commandtext = sql_listar",
      "          ' 2 => smallint,",
      "          ' 3 => int",
      "          ' 16 => tinyint",
      "          ' 72 => uniqueidentifier",
      "          ' 131 => bigint",
      "          ' 200 => varchar",
      "          .parameters.append .createparameter(\"@id\", ${5:72}, 1, ${6:tamanho_campo}, id)",
      "          set rs_listar = .execute",
      "        end with",
      "        if not rs_listar.eof then",
      "          logbd(commandsql(comando_sql))",
      "          ' Definir Variáveis Formulário",
      "          ' Snippet rss",
      "          $0",
      "          'Outros Dados",
      "          utilizador_registo = rs_listar(\"utilizador_registo\")",
      "          data_registo = rs_listar(\"data_registo_formatada\")",
      "          utilizador_alteracao = rs_listar(\"utilizador_alteracao\")",
      "          data_alteracao = rs_listar(\"data_alteracao_formatada\")",
      "        else",
      "          logerros(commandsql(comando_sql))",
      "          operacao = \"registar\"",
      "        end if",
      "        rs_listar.close : set rs_listar = nothing",
      "      end if",
      "%>",
      "      <form id=\"<%=app%>_form\" class=\"formulario\">",
      "        <% if id <> \"\" then %>",
      "          <input type=\"hidden\" name=\"<%=id_tabela%>\" value=\"<%=id%>\"/>",
      "        <% end if %>",
      "        <input type=\"hidden\" name=\"<%=seletor_paginas%>\" value=\"<%=operacao%>\"/>",
      "        <ol>",
      "          <li class=\"FormSeparador\"><label>Titulo Formulario</label></li>",
      "          <!-- CAMPOS FORMULÁRIO -->",
      "          ",
      "          <!-- OUTROS DADOS -->",
      "          <% if p <> \"adicionar\" then %>",
      "            <li class=\"FormSeparador\" title=\"Outros Dados\"><label><i class=\"fa fa-info margin-r-5\"></i>Outros dados</label></li>",
      "            <li>",
      "              <label>Utilizador registo</label>",
      "              <span class=\"leitura\">",
      "                <span class=\"texto-upper\"><%=utilizador_registo%></span> - (<%=get_utilizador_nome(utilizador_registo)%>)",
      "              </span>",
      "            </li>",
      "            <li>",
      "              <label>Data registo</label>",
      "              <span class=\"leitura\"><%=data_registo%></span>",
      "            </li>",
      "            <% if utilizador_alteracao <> \"\" then %>",
      "              <li>",
      "                <label>Utilizador alteração</label>",
      "                <span class=\"leitura\">",
      "                  <span class=\"texto-upper\"><%=utilizador_alteracao%></span> - (<%=get_utilizador_nome(utilizador_registo)%>)",
      "                </span>",
      "              </li>",
      "              <li>",
      "                <label>Data alteração</label>",
      "                <span class=\"leitura\"><%=data_alteracao%></span>",
      "              </li>",
      "            <% end if %>",
      "          <% end if %>",
      "        </ol>",
      "      </form>",
      "      <div class=\"fechar-form\" title=\"Fechar formulário\"></div>",
      "      <script type=\"text/javascript\">",
      "        const formulario = $('#<%=app%>_form');",
      "        formulario.next('.fechar-form').on('click', function () { fecharFormulario(formulario) });",
      "        formulario.validar({",
      "          <% if p = \"visualizar\" then %>",
      "            formLeitura: true,",
      "          <% end if %>",
      "          complete: function () {",
      "            $.post(",
      "              '<%=pagina_atual%>',",
      "              formulario.serialize(),",
      "              function (res) {",
      "                if (res.result.toLowerCase() === 'ok') {",
      "                  msgcarregando($('#<%=div_listagem%>'));",
      "                  fecharFormulario(formulario);",
      "                  $.post(",
      "                    '<%=pagina_atual%>',",
      "                    { '<%=seletor_paginas%>': '<%=seletor_listar%>' },",
      "                    function (data) {",
      "                      $('#<%=div_listagem%>').html(data);",
      "                      alertify.success(res.msg);",
      "                      formulario.validar('completo');",
      "                    }",
      "                  );",
      "                }",
      "                else { alertify.error(res.msg); formulario.validar('completo'); }",
      "              },",
      "              'json'",
      "            );",
      "          }",
      "        });",
      "      </script>",
      "<%",
      "      ligacao.close : set ligacao = nothing",
      "    case \"registar\", \"atualizar\", \"eliminar\"",
      "      set sql_dados_operacoes = new sqldados",
      "      sql_dados_operacoes.conn = $4",
      "      if isadmin() then sql_dados_operacoes.debug = true",
      "      sql_dados_operacoes.tabela = nome_tabela",
      "      sql_dados_operacoes.idname = id_tabela",
      "      select case p",
      "        case \"registar\"",
      "          sql_dados_operacoes.addcampo \"utilizador_registo\", session(\"utilizador\")",
      "        case \"atualizar\"",
      "          sql_dados_operacoes.tiposql = 1",
      "          sql_dados_operacoes.addcampo \"data_alteracao\", \"GETDATE()\"",
      "          sql_dados_operacoes.addcampo \"utilizador_alteracao\", session(\"utilizador\")",
      "        case \"eliminar\"",
      "          sql_dados_operacoes.tiposql = 2",
      "      end select",
      "      sql_dados_operacoes.executar()",
      "      sql_dados_operacoes.retorno.flush",
      "      set sql_dados_operacoes = nothing",
      "    case seletor_listar",
      "      set obj_listar_dados = new listardados",
      "      obj_listar_dados.conn = $4",
      "      if isadmin() then obj_listar_dados.debug = true",
      "      obj_listar_dados.appname = app",
      "      obj_listar_dados.tabela = nome_tabela & \"_view\"",
      "      obj_listar_dados.tabelaid = id_tabela",
      "      obj_listar_dados.pagina = pagina_atual",
      "      obj_listar_dados.seletorlistar = seletor_listar",
      "      obj_listar_dados.divlistagem = div_listagem",
      "      obj_listar_dados.divacoes = div_acoes",
      "      obj_listar_dados.ordenarpor = null",
      "      'obj_listar_dados.addcamposlistagem array(campo, label, percentagem, tipo_campo, alinhamento, Formatação Campo, footer, Formatações TR)",
      "      'ai-listardados-addcampo - snippet para adicionar campos",
      "      ",
      "      'ai-listardados-addacoes - snippet para adicionar ações",
      "      ",
      "      obj_listar_dados.listartabela()",
      "      set obj_listar_dados = nothing",
      "    case else",
      "%>",
      "      <div class=\"listar-pesquisa\">",
      "        <div class=\"listar-pesquisa-item\">",
      "          <span class=\"listar-pesquisa-export excel\" onclick=\"downloadExcel('<%=app%>_tabela', '<%=app%>_listagem')\">Exportar listagem</span>",
      "        </div>",
      "        <div class=\"listar-pesquisa-item\">|</div>",
      "        <div class=\"listar-pesquisa-item\">",
      "          <span class=\"listar-pesquisa-print\" onclick=\"imprimirListagem('<%=app%>_tabela', 'Listagem registos')\">Imprimir listagem</span>",
      "        </div>",
      "        <div class=\"listar-pesquisa-item\">|</div>",
      "        <div class=\"listar-pesquisa-item\"><span class=\"listar-pesquisa-texto\">Registos:</span></div>",
      "        <div class=\"listar-pesquisa-item\">",
      "          <select id=\"<%=app%>_totalpage\">",
      "            <option value=\"10\">10</option>",
      "            <option value=\"25\">25</option>",
      "            <option value=\"50\">50</option>",
      "            <option value=\"100\">100</option>",
      "            <option value=\"All\">Todos</option>",
      "          </select>",
      "        </div>",
      "        <div class=\"listar-pesquisa-item\"><input id=\"<%=app%>_search\" type=\"text\"></div>",
      "      </div>",
      "      <div class=\"listar-divlistagem\" id=\"<%=div_listagem%>\"></div>",
      "      <div class=\"listar-divacoes\" id=\"<%=div_acoes%>\"></div>",
      "      <script type=\"text/javascript\">",
      "        const totalPorPagina = $('#<%=app%>_totalpage');",
      "        msgcarregando($('#<%=div_listagem%>'));",
      "        const carregarPagina = function (dadosPost = {}) {",
      "          dadosPost = $.extend(",
      "            { '<%=seletor_paginas%>': '<%=seletor_listar%>' },",
      "            dadosPost",
      "          );",
      "          msgcarregando($('#<%=div_listagem%>'));",
      "          $.post(",
      "            '<%=pagina_atual%>',",
      "            dadosPost,",
      "            function (h) { $('#<%=div_listagem%>').html(h) }",
      "          );",
      "          pesquisarRegistosV2(",
      "            $('#<%=app%>_search'),",
      "            $('#<%=div_listagem%>'),",
      "            '<%=pagina_atual%>',",
      "            dadosPost,",
      "            $('#<%=div_acoes%>')",
      "          );",
      "        }",
      "        carregarPagina();",
      "        totalPorPagina.on('change', () => { carregarPagina({ 'm': totalPorPagina.val() }) });",
      "        <% if session(app & \"_m\") <> \"\" then %>",
      "          totalPorPagina.val('<%=session(app & \"_m\")%>');",
      "        <% end if %>",
      "      </script>",
      "<%",
      "  end select",
      "%>"
    ],
    "description": "Página Completa"
  },
  "Fechar HTML": {
    "prefix": "ai-fechar-html",
    "body": "<div class=\"fechar-form\" title=\"Fechar formulário\"></div>",
    "description": "HTML com setas indicadores para fechar div"
  },
  "Separador Formulário": {
    "prefix": "ai-form-separador",
    "body": "<li class=\"FormSeparador\"><label><i class=\"fa fa-search margin-r-5\"></i>${1:Titulo Separador}</label></li>",
    "description": "Separador de secção de formulário"
  },
  "Inputs Distrito, Concelho e Freguesia": {
    "prefix": "ai-form-ilha-concelho-freguesia",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_distrito}\">${2:Ilha}</label>",
      "  <select",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    data-tipo=\"select\"",
      "    data-tabela=\"{EA6CF4AC-9A84-4FC9-8208-89117A7E9002}\"",
      "    data-filho=\"<%=app%>_${5:id_concelho}\"",
      "    class=\"${3:obrigatorio}\"",
      "    data-selecionado=\"${4:<%=$1%>}\"",
      "  >",
      "    <option value=\"\">A Carregar...</option>",
      "  </select>",
      "</li>",
      "<li>",
      "  <label for=\"<%=app%>_$5\">${6:Concelho}</label>",
      "  <select",
      "    id=\"<%=app%>_$5\"",
      "    name=\"$5\"",
      "    data-tipo=\"select\"",
      "    data-tabela=\"{046ADB92-A93D-46A2-B69D-7BF93DF1CFB2}\"",
      "    data-filho=\"<%=app%>_${9:id_freguesia}\"",
      "    class=\"${7:obrigatorio}\"",
      "    data-selecionado=\"${8:<%=$5%>}\"",
      "  >",
      "    <option value=\"\">Por favor escolha a Ilha...</option>",
      "  </select>",
      "</li>",
      "<li>",
      "  <label for=\"<%=app%>_$9\">${10:Freguesia}</label>",
      "  <select",
      "    id=\"<%=app%>_$9\"",
      "    name=\"$9\"",
      "    data-tipo=\"select\"",
      "    data-tabela=\"{7146DE3B-7C02-4E9F-8D64-95ABC4538EB8}\"",
      "    class=\"${11:obrigatorio}\"",
      "    data-selecionado=\"${12:<%=$9%>}\"",
      "  >",
      "    <option value=\"\">Por favor escolha a Concelho...</option>",
      "  </select>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, campos distrito, concelho e freguesia já encadeados"
  },
  "Input Select": {
    "prefix": "ai-form-select",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_$1\">${2:Select}</label>",
      "  <select",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    class=\"${3:obrigatorio}\"",
      "    data-tipo=\"select\"",
      "    data-tabela=\"${4:Consultar ID ou criar em NAI > AI > Gestão caixas de listagem}\"",
      "    data-selecionado=\"${5:<%=$1%>}\"",
      "  >",
      "    <option value=\"\">A carregar...</option>",
      "  </select>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, select para tabela"
  },
  "Input Select Sim Não": {
    "prefix": "ai-form-select-simnao",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_select}\">${2:Select}</label>",
      "  <select",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    class=\"${3:obrigatorio}\"",
      "    data-tipo=\"select\"",
      "    data-preenchimento=\"${4:<%=$1%>}\"",
      "  >",
      "    <option value=\"\">Escolha um item...</option>",
      "    <option value=\"0\">Não</option>",
      "    <option value=\"1\">Sim</option>",
      "  </select>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, select com Sim e Não"
  },
  "Input Geral": {
    "prefix": "ai-form-geral",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_campo}\">${2:Titulo campo}</label>",
      "  <input",
      "    type=\"text\"",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    data-tipo=\"${3|ano,artigo,cae,codpostal,data,datahoraseparados,decimal,email,faturafarmacia,fax,hora,iban,idcodpostal,km,mac,matricula,moeda,nib,nif,niss,nissee,nissps,numerico,percentagem,sgc,telefone,texto,voip|}\"",
      "    class=\"${4:obrigatorio}\"",
      "    data-preenchimento=\"${5:<%=$1%>}\"",
      "  />",
      "  ${6:<div class=\"descricao\">${7:Valor Informativo}</div>}",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input genérico"
  },
  "Input Data Nascimento": {
    "prefix": "ai-form-data-nascimento-com-idade",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_campo}\">${2:Titulo campo}</label>",
      "  <input",
      "    type=\"text\"",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    data-tipo=\"data\"",
      "    class=\"${3:obrigatorio}\"",
      "    data-preenchimento=\"<%=$1%>\"",
      "    ${4: data-calcularidade=\"<%=app%>_${6:idade}\"}",
      "  />",
      "</li>",
      "${5:<li>",
      "  <label>${7:Idade}</label>",
      "  <b><span class=\"leitura\" id=\"<%=app%>_$6\">-</span></b>",
      "</li>}",
      "$0"
    ],
    "description": "HTML para formulário, input data de nascimento com idade"
  },
  "Input NISSWS": {
    "prefix": "ai-form-nissws",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_campo}\">${2:Titulo campo}</label>",
      "  <input",
      "    type=\"text\"",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    data-tipo=\"nissws\"",
      "    data-retorno=\"${3:nif|nome|datnas|sexo|ndocid|morada|distrito|concelho|freguesia|codpostal|nomepai|nomemae}\"",
      "    data-campos=\"${4:campos}\"",
      "    data-disabledretorno=\"${5:true|false}\"",
      "    class=\"${6:obrigatorio}\"",
      "    data-preenchimento=\"${7:<%=$1%>}\"",
      "  />",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input NISS WS"
  },
  "Input NIFWS": {
    "prefix": "ai-form-nifws",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_campo}\">${2:Titulo campo}</label>",
      "  <input",
      "    type=\"text\"",
      "    id=\"<%=app%>_$1\"",
      "    name=\"$1\"",
      "    data-tipo=\"nifws\"",
      "    data-campo=\"<%=app%>_${3:id_campo_niss}\"",
      "    class=\"${4:obrigatorio}\"",
      "    data-preenchimento=\"${5:<%=$1%>}\"",
      "  />",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input NIF WS"
  },
  "Input Sexo": {
    "prefix": "ai-form-sexo",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_campo}\">${2:Titulo campo}</label>",
      "  <select id=\"<%=app%>_$1\" name=\"$1\" data-tipo=\"select\" class=\"${3:obrigatorio}\" data-preenchimento=\"<%=$1%>\">",
      "    <option value=\"\">Escolha um Item...</option>",
      "    <option value=\"F\">Feminino</option>",
      "    <option value=\"M\">Masculino</option>",
      "  </select>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, select Feminino e Masculino"
  },
  "Input Upload": {
    "prefix": "ai-form-upload",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:id_campo}\">${2:Titulo Campo}</label>",
      "  <input id=\"<%=app%>_$1\" name=\"$1\" type=\"file\" data-tipo=\"upload\" data-extensoes=\"${3:png|jpeg|jpg|gif}\" class=\"${4:obrigatorio}\" data-tamanho=\"$5\"/>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input upload"
  },
  "Input Radio ou Checkbox": {
    "prefix": "ai-form-radio-checkbox",
    "body": [
      "<li>",
      "  <fieldset data-tipo=\"${1|radio,checkbox|}\" class=\"${2:obrigatorio}\"${3: data-outra=\"${4:Texto Outra}\"} data-preenchimento=\"<%=${5:id_campo}%>\">",
      "    <legend>${6:Titulo}:</legend>",
      "    <span class=\"fieldset\">",
      "      (div>input[type=$1][name=\"$5\"][id=\"<%=app%>_$5_\\$\"][value=\"\"]+label[for=\"<%=app%>_$5_\\$\"])*${8:4}$0",
      "    </span>",
      "  </fieldset>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input radio ou checkbox com código Emmet para varias opções"
  },
  "Input Radio ou Checkbox a partir de tabela": {
    "prefix": "ai-form-radio-checkbox-tabela",
    "body": [
      "<li>",
      "  <fieldset id=\"<%=app%>_${1:id_campo}\" name=\"$1\" class=\"${2:obrigatorio}\" data-tipo=\"${3|radio,checkbox|}\" data-tabela=\"${4:tabela}\" data-selecionado=\"<%=$1%>\">",
      "    <legend>${5:Titulo}:</legend>",
      "    <span class=\"fieldset\"></span>",
      "  </fieldset>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input radio ou checkbox com seletores para tabela"
  },
  "Input Radio Sim Nao": {
    "prefix": "ai-form-radio-simnao",
    "body": [
      "<li>",
      "  <fieldset data-tipo=\"radio\" class=\"${1:obrigatorio}\" data-preenchimento=\"<%=${2:id_campo}%>\">",
      "    <legend>${3:Titulo}:</legend>",
      "    <span class=\"fieldset\">",
      "      <div><input type=\"radio\" name=\"$2\" id=\"<%=app%>_$2_1\" value=\"1\"><label for=\"<%=app%>_$2_1\">Sim</label></div>",
      "      <div><input type=\"radio\" name=\"$2\" id=\"<%=app%>_$2_2\" value=\"0\"><label for=\"<%=app%>_$2_2\">Não</label></div>",
      "    </span>",
      "  </fieldset>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input radio para Sim e Não"
  },
  "Input TextArea": {
    "prefix": "ai-form-textarea",
    "body": [
      "<li>",
      "  <label for=\"<%=app%>_${1:observacoes}\">${2:Observações}</label>",
      "  <textarea id=\"<%=app%>_$1\" name=\"$1\" class=\"${3:obrigatorio}\" cols=\"50\" rows=\"5\"${4: data-max=\"${5:500}\"} data-tipo=\"texto\"><%=$1%></textarea>",
      "</li>",
      "$0"
    ],
    "description": "HTML para formulário, input para observações e campos de texto longo"
  },
  "Outros Dados": {
    "prefix": "ai-outros-dados-form",
    "body": [
      "<% if p <> \"${1:adicionar}\" then %>",
      "  <li class=\"FormSeparador\"><label>${2:Outros dados}</label></li>",
      "  <li>",
      "    <label>Utilizador registo</label>",
      "    <span class=\"leitura\">",
      "      <span class=\"texto-upper\"><%=${3:utilizador_registo}%></span> - (<%=get_utilizador_nome($3)%>)",
      "    </span>",
      "  </li>",
      "  <li>",
      "    <label>Data registo</label>",
      "    <span class=\"leitura\"><%=${4:data_registo}%></span>",
      "  </li>",
      "  <% if ${5:utilizador_alteracao} <> \"\" then %>",
      "    <li>",
      "      <label>Utilizador alteração</label>",
      "      <span class=\"leitura\">",
      "        <span class=\"texto-upper\"><%=$5%></span> - (<%=get_utilizador_nome($5)%>)",
      "      </span>",
      "    </li>",
      "    <li>",
      "      <label>Data alteração</label>",
      "      <span class=\"leitura\"><%=${6:data_alteracao}%></span>",
      "    </li>",
      "  <% end if %>",
      "<% end if %>",
      "$0"
    ],
    "description": "HTML para formulário, dados de registo e alteração"
  },
  "Formulario": {
    "prefix": "ai-formulario-base",
    "body": [
      "<form id=\"<%=app%>_${1:form}\" class=\"formulario\">",
      "  <input type=\"hidden\" name=\"<%=id_tabela%>\" value=\"<%=id%>\"/>",
      "  <input type=\"hidden\" name=\"<%=seletor_paginas%>\" value=\"<%=p%>\"/>",
      "  <ol>",
      "    <li class=\"FormSeparador\"><label><i class=\"fa fa-search margin-r-5\"></i>${2:Titulo formulário}</label></li>",
      "    $0",
      "  </ol>",
      "</form>",
      "<div class=\"fechar-form\" title=\"Fechar formulário\"></div>",
      "<script type=\"text/javascript\">",
      "  const formulario = $('#<%=app%>_$1');",
      "  formulario.next('.fechar-form').on('click', function () { fecharFormulario(formulario) });",
      "  formulario.validar({",
      "    <% if p = \"visualizar\" then %>",
      "      formLeitura: true,",
      "    <% end if %>",
      "    complete: function () {",
      "      $.post(",
      "        '<%=pagina_atual%>',",
      "        formulario.serialize(),",
      "        function (res) {",
      "          if (res.result.toLowerCase() === 'ok') {",
      "            msgcarregando($('#<%=div_listagem%>'));",
      "            $.post(",
      "              '<%=pagina_atual%>',",
      "              { '<%=seletor_paginas%>': '<%=seletor_listar%>' },",
      "              function (data) {",
      "                $('#<%=div_listagem%>').html(data);",
      "                alertify.success(res.msg);",
      "                formulario.validar('completo');",
      "              }",
      "            );",
      "          }",
      "          else { alertify.error(res.msg); formulario.validar('completo'); }",
      "        },",
      "        'json'",
      "      );",
      "    }",
      "  });",
      "</script>"
    ],
    "description": "HTML com formulário base e javascript de validação inicial"
  },
  "Tabuladores": {
    "prefix": "ai-tabs",
    "body": [
      "<div id=\"<%=app%>_${1:tabs}\" class=\"tabs\">",
      "  <div class=\"separadores\">",
      "    <div class=\"item active\" data-pagina=\"${2:pagina1}\"><p>${3:Texto Tab 1}</p></div>",
      "    <div class=\"item\" data-pagina=\"${4:pagina2}\"><p>${5:Texto Tab 2}</p></div>",
      "  </div>",
      "  <div class=\"conteudo\"></div>",
      "</div>",
      "<script type=\"text/javascript\">",
      "  $('#<%=app%>_$1').tabs({",
      "    OnClick: function (pagina) {",
      "      const conteudo = $(this);",
      "      msgcarregando(conteudo);",
      "      $.post(",
      "        '<%=pagina_atual%>',",
      "        { '<%=seletor_paginas%>': pagina },",
      "        function (data) { conteudo.html(data) }",
      "      );",
      "    }",
      "  });",
      "</script>",
      "$0"
    ],
    "description": "HTML para criação de tabs já com javascript inicial"
  },
  "SQLDados Todos em um": {
    "prefix": "ai-sqldados-all-in-one",
    "body": [
      "case \"registar\", \"atualizar\", \"eliminar\"",
      "  set sql_dados_obj = new sqldados",
      "  sql_dados_obj.conn = ${1|conexao,conexaoconsultas,conexaocaaf,conexaointranet,conexaocdm,conexaofeac,conexaologs,conexaoestatisticas,conexaorelogiodeponto,conexaocompamid,conexaocrp,conexaodev,conexaoidq,conexaosgc,conexaosiads,conexaoemrrci,conexaoplataforma,conexaoSAPA|}",
      "  sql_dados_obj.tabela = nome_tabela",
      "  sql_dados_obj.idname = id_tabela",
      "  select case p",
      "    case \"registar\"",
      "      sql_dados_obj.addcampo \"${2:utilizador_registo}\", session(\"utilizador\")",
      "    case \"atualizar\"",
      "      sql_dados_obj.tiposql = 1",
      "      sql_dados_obj.addcampo \"${3:data_alteracao}\", \"GETDATE()\"",
      "      sql_dados_obj.addcampo \"${4:utilizador_alteracao}\", session(\"utilizador\")",
      "    case \"eliminar\"",
      "      sql_dados_obj.tiposql = 2",
      "  end select",
      "  sql_dados_obj.executar()",
      "  sql_dados_obj.retorno.flush",
      "  set sql_dados_obj = nothing",
      "$0"
    ],
    "description": "SQL Dados com todas as ações registar/atualizar/eliminar"
  },
  "SQLDados": {
    "prefix": "ai-sqldados",
    "body": [
      "set sql_dados_list = new sqldados",
      "sql_dados_list.conn = ${1|conexao,conexaoconsultas,conexaocaaf,conexaointranet,conexaocdm,conexaofeac,conexaologs,conexaoestatisticas,conexaorelogiodeponto,conexaocompamid,conexaocrp,conexaodev,conexaoidq,conexaosgc,conexaosiads,conexaoemrrci,conexaoplataforma,conexaoSAPA|}",
      "sql_dados_list.tabela = ${2:nome_tabela}",
      "sql_dados_list.idname = ${3:id_tabela}",
      "sql_dados_list.tiposql = ${4|0 'INSERT,1 'UPDATE,2 'DELETE|}",
      "sql_dados_list.guid = ${5|false,true|}",
      "sql_dados_list.newguid = ${6|NULL,criarguid()|}",
      "sql_dados_list.msgregistoadd = \"${7:Registo introduzido com sucesso}\"",
      "sql_dados_list.msgregistoedit = \"${8:Registo atualizado com sucesso}\"",
      "sql_dados_list.msgregistodel = \"${9:Registo eliminado com sucesso}\"",
      "sql_dados_list.output = ${10|false,true|} 'Esta opção só pode ser usada com ID sequencial",
      "sql_dados_list.debug = ${11|false,true|}",
      "sql_dados_list.insertprimarykey = ${12|false,true|}",
      "sql_dados_list.timeoutconn = ${13:15}",
      "${14:SQLObj.addignorar \"\" 'Adicionar nome do campo a ser ignorado}",
      "${15:sql_dados_list.addcampo \"utilizador_registo\", session(\"utilizador\")}",
      "${16:sql_dados_list.addcampo \"data_alteracao\", \"GETDATE()\"}",
      "${17:sql_dados_list.addcampo \"utilizador_alteracao\", session(\"utilizador\")}",
      "${18:sql_dados_list.addretorno \"utilizador\", session(\"utilizador\")}",
      "${19:sql_dados_list.addnaoduplicar \"campo\"}",
      "sql_dados_list.executar()",
      "sql_dados_list.retorno.flush",
      "set sql_dados_list = nothing",
      "$0"
    ],
    "description": "SQL Dados com todas as opções possíveis de configurar"
  },
  "ListarDados": {
    "prefix": "ai-listardados",
    "body": [
      "Set obj_listar_dados = new listardados",
      "obj_listar_dados.conn = ${1|conexao,conexaoconsultas,conexaocaaf,conexaointranet,conexaocdm,conexaofeac,conexaologs,conexaoestatisticas,conexaorelogiodeponto,conexaocompamid,conexaocrp,conexaodev,conexaoidq,conexaosgc,conexaosiads,conexaoemrrci,conexaoplataforma,conexaoSAPA|}",
      "obj_listar_dados.appname = ${2:app}",
      "obj_listar_dados.tabela = ${3:nome_tabela}",
      "obj_listar_dados.tabelaid = ${4:id_tabela}",
      "obj_listar_dados.filtro = ${5:null}",
      "obj_listar_dados.pagina = ${6:pagina_atual}",
      "obj_listar_dados.seletorlistar = ${7:seletor_listar}",
      "obj_listar_dados.divlistagem = ${8:div_listagem}",
      "obj_listar_dados.divacoes = ${9:div_acoes}",
      "obj_listar_dados.debug = ${11|false,true|}",
      "obj_listar_dados.padd = ${12|true,false|}",
      "obj_listar_dados.pview = ${13|true,false|}",
      "obj_listar_dados.pedit = ${14|true,false|}",
      "obj_listar_dados.pdelete = ${15|true,false|}",
      "obj_listar_dados.paginar = ${16|true,false|}",
      "obj_listar_dados.ordenarpor = ${17:null}",
      "'obj_listar_dados.addcamposlistagem array(campo, label, percentagem, tipo_campo, alinhamento, Formatação Campo, footer, Formatações TR)",
      "'ai-listardados-addcampo",
      "$0",
      "'obj_listar_dados.addacoes array(funcao, tipo_campo, valor, label, atributos)",
      "'ai-listardados-addacoes",
      "",
      "obj_listar_dados.listartabela()",
      "set obj_listar_dados = nothing"
    ],
    "description": "Listar Dados"
  },
  "ListarDados Adicionar Novo Campo": {
    "prefix": "ai-listardados-addcampo",
    "body": "obj_listar_dados.addcamposlistagem array(\"${1:campo}\", \"${2:label}\", ${3:null}, ${4|null,\"texto\",\"inteiro\",\"decimal\",\"horas\",\"hora\",\"data\",\"bit\",\"datahora\",\"percentagem\",\"moeda\",\"moedacores\",\"email\",\"link\",\"estado\"|}${5:, ${6|\"center\",\"left\",\"right\"|}, ${7:null}, ${8|null,\"soma\"|}, ${9:null}})",
    "description": "Listar Dados Adicionar Campo"
  },
  "ListarDadosAcoes": {
    "prefix": "ai-listardados-addacoes",
    "body": "obj_listar_dados.addacoes array(\"${1:funcao}\", \"${2|icon,link|}\", \"${3:valor}\", \"${4:label}\", ${5|null,\"atributos html\"|})",
    "description": "Listar Dados Adicionar Ação"
  },
  "To JSON": {
    "prefix": "ai-listar-json-asp",
    "body": [
      "set obj_dados = jsobject()",
      "sql = \"SELECT ${1:id} AS value, ${2:campo} AS text FROM ${3:tabela}\"",
      "set obj_dados(\"dados\") = querytojson(ligacao, sql)",
      "if err.number <> 0 then",
      "  obj_dados.remove \"dados\"",
      "  obj_dados(\"result\") = \"erro\"",
      "  obj_dados(\"msg\") = \"Problema ao consultar dados\"",
      "else",
      "  obj_dados(\"result\") = \"ok\"",
      "end if",
      "obj_dados.flush",
      "set obj_dados = nothing",
      "$0"
    ],
    "description": "Código ASP para carregar JSON com dados de Tabela"
  },
  "Abrir Ligacao": {
    "prefix": "ai-abrir-ligacao",
    "body": [
      "set ligacao = server.createobject(\"adodb.connection\")",
      "ligacao.open ${1|conexao,conexaoconsultas,conexaocaaf,conexaointranet,conexaocdm,conexaofeac,conexaologs,conexaoestatisticas,conexaorelogiodeponto,conexaocompamid,conexaocrp,conexaodev,conexaoidq,conexaosgc,conexaosiads,conexaoemrrci,conexaoplataforma,conexaoSAPA|}",
      "if err.number <> 0 then",
      "  logerros(err.description)",
      "  err.clear",
      "end if",
      "$0"
    ],
    "description": "Abrir Ligação"
  },
  "Fechar Objeto": {
    "prefix": "ai-fechar-objeto",
    "body": "${1|ligacao,rs|}.close : set $1 = nothing",
    "description": "Fechar objeto de ASP"
  },
  "Registo Stored Procedure": {
    "prefix": "ai-executar-stored-procedure",
    "body": [
      "set obj_json = jsobject()",
      "set comando_sql = server.createobject(\"adodb.command\")",
      "with comando_sql",
      "  .activeconnection = ligacao",
      "  .commandtext = \"${1:stored_procedure}\"",
      "  .commandtype = 4",
      "  .parameters.item(\"@${2:campo_obrigatorio}\").value = $2",
      "  if ${3:campo_nao_obrigatorio} <> \"\" then .parameters.item(\"@$3\").value = $3",
      "  $0",
      "  .execute",
      "  obj_json(\"result\") = .parameters(\"@result\")",
      "  obj_json(\"msg\") = .parameters(\"@msg\")",
      "end with",
      "obj_json.flush",
      "set obj_json = nothing"
    ]
  },
  "Listar Dados": {
    "prefix": "ai-listar-sql",
    "body": [
      "sql_listar = \"$1\"",
      "set comando_sql = server.createobject(\"adodb.command\")",
      "with comando_sql",
      "  .activeconnection = ligacao",
      "  .commandtext = sql_listar",
      "  ' 2 => smallint,",
      "  ' 3 => int",
      "  ' 16 => tinyint",
      "  ' 72 => uniqueidentifier",
      "  ' 131 => bigint",
      "  ' 200 => varchar",
      "  .parameters.append .createparameter(\"@id\", ${2:72}, 1, ${3:tamanho_campo}, id)",
      "  set rs_listar = .execute",
      "end with",
      "if not rs_listar.eof then",
      "  logbd(commandsql(comando_sql))",
      "  ' Snippet rss",
      "  $0",
      "else",
      "  logerros(commandsql(comando_sql))",
      "end if",
      "rs_listar.close : set rs_listar = nothing"
    ]
  },
  "carregar variavel": {
    "prefix": "rss",
    "body": [
      "$1 = rs_listar(\"$1\")",
      "$0"
    ],
    "description": "rs_listar campo"
  }
}